# Messaging in ACUA

## Overview

ACUA is a platform based on a microservices architecture. These microservices communicate among eachother using a messaging system. The platform used will be Apache Kafka.
This document will describe the events that are produced and consumed by the microservices in ACUA, as well as the basic message structure that is shared between all of them.

## Message Structure

All messages in ACUA will be JSON objects. In order to link the right message to the right request, the "Correlation Identifier" pattern will be used. This means that every message will have a unique identifier that will be used to link it to the request that originated it. This identifier will be a UUID generated by the microservice that originated the message, more often than not, the API Gateway. More about this pattern can be read [here](https://www.enterpriseintegrationpatterns.com/patterns/messaging/CorrelationIdentifier.html).
To support this pattern, each message will have a few attributes that is shared between all message types:

```json
{
  "correlationId": "171d7713-82dc-485c-a578-e249b3650fd9",
  "payload": {}
}
```

Each type of message has its own topic to keep things organised.

## Message Types (Events/Topics)

**Retrieval**: These events are produced when a resource is retrieved from the database. They are consumed by the API Gateway and used to respond to the client.

**Creation**: These events are produced when a resource is created in the database by a microservice. They can be consumed by other microservices that need to know about the creation of a resource.

**Updating**: These events are produced when a resource is updated in the database by a microservice. They can be consumed by other microservices that need to know about the update of a resource.

**Deletion**: These events are produced when a resource is deleted from the database by a microservice. They can be consumed by other microservices that need to know about the deletion of a resource.

### User Management

- UserRetrieved
- UserCreated
- UserUpdated
- UserDeleted

### Repair Requests

- RepairRequestRetrieved
- RepairRequestCreated
- RepairRequestUpdated
- RepairRequestDeleted
- RepairRequestAssigned
- RepairRequestUnassigned

### Timers

- TimerRetrieved
- TimerCreated
- TimerDeleted
- TimerStarted
- TimerStopped

### Notifications

- NotificationSent
- NotificationCreated

### Reservations

- ReservationRetrieved
- ReservationCreated
- ReservationUpdated
- ReservationDeleted

### QR Codes

- QRCodeRetrieved
- QRCodeCreated
- QRCodeDeleted
